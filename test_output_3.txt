
> chat-booking-admin-panel@1.0.0 test
> jest src/app/settings/tabs/__tests__/ApiKeysTab.test.tsx

FAIL src/app/settings/tabs/__tests__/ApiKeysTab.test.tsx
  ApiKeysTab
    ‚úì renders loading state initially (26 ms)
    ‚úï renders empty state when no keys (23 ms)
    ‚úì renders list of api keys (28 ms)
    ‚úì opens create dialog and creates a new key (71 ms)
    ‚úï handles copy to clipboard (1002 ms)
    ‚úì revokes a key (31 ms)
    ‚úï handles errors gracefully (1001 ms)

  ‚óè ApiKeysTab ‚Ä∫ renders empty state when no keys

    TestingLibraryElementError: Unable to find an element with the text: noKeys. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiBox-root css-qd5mg9"[39m
        [36m>[39m
          [36m<span[39m
            [33mclass[39m=[32m"MuiCircularProgress-root MuiCircularProgress-indeterminate MuiCircularProgress-colorPrimary css-18lrjg1-MuiCircularProgress-root"[39m
            [33mrole[39m=[32m"progressbar"[39m
            [33mstyle[39m=[32m"width: 40px; height: 40px;"[39m
          [36m>[39m
            [36m<svg[39m
              [33mclass[39m=[32m"MuiCircularProgress-svg css-1idz92c-MuiCircularProgress-svg"[39m
              [33mviewBox[39m=[32m"22 22 44 44"[39m
            [36m>[39m
              [36m<circle[39m
                [33mclass[39m=[32m"MuiCircularProgress-circle MuiCircularProgress-circleIndeterminate css-176wh8e-MuiCircularProgress-circle"[39m
                [33mcx[39m=[32m"44"[39m
                [33mcy[39m=[32m"44"[39m
                [33mfill[39m=[32m"none"[39m
                [33mr[39m=[32m"20.2"[39m
                [33mstroke-width[39m=[32m"3.6"[39m
              [36m/>[39m
            [36m</svg>[39m
          [36m</span>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      61 |         });
      62 |
    > 63 |         expect(screen.getByText('noKeys')).toBeInTheDocument();
         |                       ^
      64 |     });
      65 |
      66 |     it('renders list of api keys', async () => {

      at Object.getElementError (node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/@testing-library/dom/dist/query-helpers.js:76:38
      at node_modules/@testing-library/dom/dist/query-helpers.js:52:17
      at node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByText (src/app/settings/tabs/__tests__/ApiKeysTab.test.tsx:63:23)

  ‚óè ApiKeysTab ‚Ä∫ handles copy to clipboard

    expect(element).not.toBeInTheDocument()

    expected document not to contain element, found <span class="MuiCircularProgress-root MuiCircularProgress-indeterminate MuiCircularProgress-colorPrimary css-18lrjg1-MuiCircularProgress-root" role="progressbar" style="width: 40px; height: 40px;"><svg class="MuiCircularProgress-svg css-1idz92c-MuiCircularProgress-svg" viewBox="22 22 44 44"><circle class="MuiCircularProgress-circle MuiCircularProgress-circleIndeterminate css-176wh8e-MuiCircularProgress-circle" cx="44" cy="44" fill="none" r="20.2" stroke-width="3.6" /></svg></span> instead

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body[39m
        [33mstyle[39m=[32m""[39m
      [36m>[39m
        [36m<div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiBox-root css-qd5mg9"[39m
          [36m>[39m
            [36m<span[39m
              [33mclass[39m=[32m"MuiCircularProgress-root MuiCircularProgress-indeterminate MuiCircularProgress-colorPrimary css-18lrjg1-MuiCircularProgress-root"[39m
              [33mrole[39m=[32m"progressbar"[39m
              [33mstyle[39m=[32m"width: 40px; height: 40px;"[39m
            [36m>[39m
              [36m<svg[39m
                [33mclass[39m=[32m"MuiCircularProgress-svg css-1idz92c-MuiCircularProgress-svg"[39m
                [33mviewBox[39m=[32m"22 22 44 44"[39m
              [36m>[39m
                [36m<circle[39m
                  [33mclass[39m=[32m"MuiCircularProgress-circle MuiCircularProgress-circleIndeterminate css-176wh8e-MuiCircularProgress-circle"[39m
                  [33mcx[39m=[32m"44"[39m
                  [33mcy[39m=[32m"44"[39m
                  [33mfill[39m=[32m"none"[39m
                  [33mr[39m=[32m"20.2"[39m
                  [33mstroke-width[39m=[32m"3.6"[39m
                [36m/>[39m
              [36m</svg>[39m
            [36m</span>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

      124 |         mockGraphql.mockResolvedValue({ data: { listApiKeys: [] } });
      125 |         render(<ApiKeysTab hasMounted={true} />);
    > 126 |         await waitFor(() => expect(screen.queryByRole('progressbar')).not.toBeInTheDocument());
          |                                                                           ^
      127 |
      128 |         // Open dialog and reach success state (simulated by mocking state if possible, but easier via flow)
      129 |         fireEvent.click(screen.getByText('createKey'));

      at toBeInTheDocument (src/app/settings/tabs/__tests__/ApiKeysTab.test.tsx:126:75)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at MutationObserver.checkRealTimersCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at MutationObserver.invokeTheCallbackFunction (node_modules/jsdom/lib/jsdom/living/generated/MutationCallback.js:19:26)
      at notifyMutationObservers (node_modules/jsdom/lib/jsdom/living/helpers/mutation-observers.js:160:22)
      at node_modules/jsdom/lib/jsdom/living/helpers/mutation-observers.js:133:5

  ‚óè ApiKeysTab ‚Ä∫ handles errors gracefully

    expect(element).not.toBeInTheDocument()

    expected document not to contain element, found <span class="MuiCircularProgress-root MuiCircularProgress-indeterminate MuiCircularProgress-colorPrimary css-18lrjg1-MuiCircularProgress-root" role="progressbar" style="width: 40px; height: 40px;"><svg class="MuiCircularProgress-svg css-1idz92c-MuiCircularProgress-svg" viewBox="22 22 44 44"><circle class="MuiCircularProgress-circle MuiCircularProgress-circleIndeterminate css-176wh8e-MuiCircularProgress-circle" cx="44" cy="44" fill="none" r="20.2" stroke-width="3.6" /></svg></span> instead

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body[39m
        [33mstyle[39m=[32m""[39m
      [36m>[39m
        [36m<div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiBox-root css-qd5mg9"[39m
          [36m>[39m
            [36m<span[39m
              [33mclass[39m=[32m"MuiCircularProgress-root MuiCircularProgress-indeterminate MuiCircularProgress-colorPrimary css-18lrjg1-MuiCircularProgress-root"[39m
              [33mrole[39m=[32m"progressbar"[39m
              [33mstyle[39m=[32m"width: 40px; height: 40px;"[39m
            [36m>[39m
              [36m<svg[39m
                [33mclass[39m=[32m"MuiCircularProgress-svg css-1idz92c-MuiCircularProgress-svg"[39m
                [33mviewBox[39m=[32m"22 22 44 44"[39m
              [36m>[39m
                [36m<circle[39m
                  [33mclass[39m=[32m"MuiCircularProgress-circle MuiCircularProgress-circleIndeterminate css-176wh8e-MuiCircularProgress-circle"[39m
                  [33mcx[39m=[32m"44"[39m
                  [33mcy[39m=[32m"44"[39m
                  [33mfill[39m=[32m"none"[39m
                  [33mr[39m=[32m"20.2"[39m
                  [33mstroke-width[39m=[32m"3.6"[39m
                [36m/>[39m
              [36m</svg>[39m
            [36m</span>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

      204 |
      205 |         await waitFor(() => {
    > 206 |             expect(screen.getByRole('progressbar')).not.toBeInTheDocument(); // It hides spinner on error in finally block
          |                                                         ^
      207 |         });
      208 |
      209 |         // Since I added snackbar on error fetching:

      at toBeInTheDocument (src/app/settings/tabs/__tests__/ApiKeysTab.test.tsx:206:57)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at MutationObserver.checkRealTimersCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at MutationObserver.invokeTheCallbackFunction (node_modules/jsdom/lib/jsdom/living/generated/MutationCallback.js:19:26)
      at notifyMutationObservers (node_modules/jsdom/lib/jsdom/living/helpers/mutation-observers.js:160:22)
      at node_modules/jsdom/lib/jsdom/living/helpers/mutation-observers.js:133:5

Test Suites: 1 failed, 1 total
Tests:       3 failed, 4 passed, 7 total
Snapshots:   0 total
Time:        2.574 s, estimated 3 s
Ran all test suites matching src/app/settings/tabs/__tests__/ApiKeysTab.test.tsx.
